/**!
 * wp-color-picker-alpha
 *
 * Overwrite Automattic Iris for enabled Alpha Channel in wpColorPicker
 * Only run in input and is defined data alpha in true
 *
 * Version: 3.0.0
 * https://github.com/kallookoo/wp-color-picker-alpha
 * Licensed under the GPLv2 license or later.
 */
!function(n,l){var s,o={version:300};if("wpColorPickerAlpha"in window&&"version"in window.wpColorPickerAlpha){var r=parseInt(window.wpColorPickerAlpha.version,10);if(!isNaN(r)&&o.version<=r)return}Color.fn.hasOwnProperty("to_s")||(Color.fn.to_s=function(o){return"hex"===(o=o||"rgb")&&this._alpha<1&&(o="rgb"),this.toCSS(o).replace(/\s+/g,"")},window.wpColorPickerAlpha=o,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAAHnlligAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHJJREFUeNpi+P///4EDBxiAGMgCCCAGFB5AADGCRBgYDh48CCRZIJS9vT2QBAggFBkmBiSAogxFBiCAoHogAKIKAlBUYTELAiAmEtABEECk20G6BOmuIl0CIMBQ/IEMkO0myiSSraaaBhZcbkUOs0HuBwDplz5uFJ3Z4gAAAABJRU5ErkJggg==",n.widget("a8c.iris",n.a8c.iris,{alphaOptions:{alphaEnabled:!1,alphaCustomWidth:100,alphaReset:!1,alphaColorType:"hex",isDeprecated:!1},_getCurrentColor:function(o){return o===l&&(o=this._color),this.alphaOptions.alphaEnabled?o.to_s(this.alphaOptions.alphaColorType):o.toString()},_addInputListeners:function(e){function o(o){var r=e.val(),a=new Color(r),r=r.replace(/^(#|(rgb|hsl)a?)/,""),t=i.alphaOptions.alphaColorType||"hex";if(e.removeClass("iris-error"),a.error)""!==r&&e.addClass("iris-error");else if((a.toString()!==i._color.toString()||a._alpha!==i.color._alpha)&&"keyup"!==o.type){if("hex"===t&&r.match(/^[0-9a-fA-F]{3}$/))return;i._setOption("color",i._getCurrentColor(a))}}var i=this;e.on("change",o).on("keyup",i._debounce(o,100)),i.options.hide&&e.one("focus",function(){i.show()})},_dimensions:function(o){if(this._super(o),this.alphaOptions.alphaEnabled){for(var r=this,a=r.options,t=r.controls.square,e=r.picker.find(".iris-strip"),i=Math.round(r.picker.outerWidth(!0)-(a.border?22:0)),l=Math.round(t.outerWidth()),n=Math.round((i-l)/2),s=Math.round(n/2),p=Math.round(l+2*n+2*s);i<p;)n=Math.round(n-2.5),s=Math.round(s-1),p=Math.round(l+2*n+2*s);t.css("margin","0"),e.width(n).css("margin-left",s+"px")}},_change:function(){var o,r,a,t,e=this,i=e.active;e._super(),e.alphaOptions.alphaEnabled&&(o=e.controls,r=parseInt(100*e._color._alpha),t=["rgb("+(a=e._color.toRgb()).r+","+a.g+","+a.b+") 0%","rgba("+a.r+","+a.g+","+a.b+", 0) 100%"],e.picker.closest(".wp-picker-container").find(".wp-color-result"),e.options.color=e._getCurrentColor(),o.stripAlpha.css({background:"linear-gradient(to bottom, "+t.join(", ")+"), url("+s+")"}),i&&o.stripAlphaSlider.slider("value",r),e._color.error||e.element.removeClass("iris-error").val(e._getCurrentColor()),e.picker.find(".iris-palette-container").on("click.palette",".iris-palette",function(){var o=n(this).data("color");e.alphaOptions.alphaReset&&(e._color._alpha=1,o=e._getCurrentColor()),e._setOption("color",o)}))},_paintDimension:function(o,r){var a=this,t=!1;a.alphaOptions.alphaEnabled&&"strip"===r&&(t=a._color,a._color=new Color(t.toString()).setHSpace(a.options.mode),a.hue=a._color.h()),a._super(o,r),t&&(a._color=t)},_setOption:function(o,r){var a=this,t=a.element;if("alphaOptions"===o){if("object"==typeof r&&(a.alphaOptions=n.extend({},a.alphaOptions,r)),!a.alphaOptions.alphaEnabled)return;a.alphaOptions.alphaCustomWidth&&t.width(parseInt(t.width()+a.alphaOptions.alphaCustomWidth,10));var e=a.controls.strip.clone(!1,!1),i=e.find(".iris-slider-offset"),l={stripAlpha:e,stripAlphaSlider:i};e.addClass("iris-strip-alpha"),i.addClass("iris-slider-offset-alpha"),e.appendTo(a.picker.find(".iris-picker-inner")),a.controls=n.extend(!0,a.controls,l),a.controls.stripAlphaSlider.slider({orientation:"vertical",min:0,max:100,step:1,value:parseInt(100*a._color._alpha),slide:function(o,r){a.active="strip",a._color._alpha=parseFloat(r.value/100),a._change.apply(a,arguments)}}),a._dimensions(!0),a._setOption("color",a._getCurrentColor())}else{if(!a.alphaOptions.alphaEnabled||"color"!==o)return a._super(o,r);r=""+r,newColor=new Color(r).setHSpace(a.options.mode),newColor.error||(a._color=newColor,a.options.color=a._getCurrentColor(),a.active="external",a._change())}},color:function(o){return!0===o?this._color.clone():o===l?this._getCurrentColor():void this.option("color",o)}}),n.widget("wp.wpColorPicker",n.wp.wpColorPicker,{_create:function(){return this._alphaOptions={alphaEnabled:!1,alphaCustomWidth:100,alphaReset:!1,alphaColorType:"hex",isDeprecated:!1},this._super()},_addListeners:function(){var e=this,t=e.element;if(!("alphaEnabled"in e.options&&e.options.alphaEnabled))return e._super();if(!e.options.alphaEnabled||!t.is("input")||"full"!==e.options.type)return e._super();var i={alphaEnabled:!0,isDeprecated:e.toggler.is("a")};n.each(e._alphaOptions,function(o,r){if("alphaEnabled"===o||"isDeprecated"===o)return!0;var a,t=o in e.options?e.options[o]:l;switch(o){case"alphaCustomWidth":t=(t=t===l?r:t)?parseInt(t,10):0,t=isNaN(t)?r:t;break;case"alphaColorType":t!==l&&t.match(/^(hex|rgb|hsl)$/)?t=r:((a=e.initialValue)&&e.options.defaultColor&&(a=e.options.defaultColor),a&&a.match(/^(rgb|hsl)/)&&(t=a.substring(0,3)));break;default:t=t===l?r:!!t}i[o]=t}),e._alphaOptions=n.extend(e._alphaOptions,i),e.toggler.css({"background-image":"url("+s+")"}),e._alphaOptions.isDeprecated?e.toggler.html('<span class="color-alpha" />'):e.toggler.css({position:"relative"}).append('<span class="color-alpha" />'),e.colorAlpha=e.toggler.find("span.color-alpha"),e.colorAlpha.css({width:"30px",height:"100%",position:"absolute",top:0,left:0,"border-top-left-radius":"2px","border-bottom-left-radius":"2px","background-color":t.val()}),t.iris({alphaOptions:e._alphaOptions,change:function(o,r){var a=t.iris("instance");e._alphaOptions.isDeprecated&&e.toggler.css({"background-image":"url("+s+")"}),e.colorAlpha.css({"background-color":a.color()}),n.isFunction(e.options.change)&&e.options.change.call(this,o,r)}}),e.wrap.on("click.wpcolorpicker",function(o){o.stopPropagation()}),e.toggler.click(function(){e.toggler.hasClass("wp-picker-open")?e.close():e.open()}),t.on("change",function(o){var r=n(this).val();(t.hasClass("iris-error")||""===r||r.match(/^(#|(rgb|hsl)a?)$/))&&(e._alphaOptions.isDeprecated&&e.toggler.removeAttr("style"),e.colorAlpha.css("background-color",""),n.isFunction(e.options.clear)&&e.options.clear.call(this,o))}),e.button.on("click",function(o){n(this).hasClass("wp-picker-clear")?(e._alphaOptions.isDeprecated&&e.toggler.removeAttr("style"),e.colorAlpha.css("background-color",""),t.val(""),n.isFunction(e.options.clear)&&e.options.clear.call(this,o),t.trigger("change")):n(this).hasClass("wp-picker-default")&&t.val(e.options.defaultColor).change()})},color:function(o){if(o===l)return this._alphaOptions.alphaEnabled?this.element.iris("instance").color():this.element.iris("option","color");this.element.iris("option","color",o)}}),n(document).ready(function(){n(".color-picker").wpColorPicker()}))}(jQuery);